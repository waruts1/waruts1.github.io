<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Collins Warutumo</title>
    <link rel="icon" href="/94432219.jpg" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js" defer></script>
  </head>
  <body class="bg-white text-gray-800 font-sans max-w-5xl mx-auto px-4 py-8">
    <header class="text-center mb-12">
      <h1 id="name" class="text-4xl font-bold mb-2"></h1>
      <p id="tagline" class="text-lg text-gray-600 mb-4"></p>
      <nav class="flex justify-center flex-wrap gap-4 mt-4">
        <a href="#about" class="text-blue-600 hover:underline">About</a>
        <a href="#experience" class="text-blue-600 hover:underline">Experience</a>
        <a href="#projects" class="text-blue-600 hover:underline">Projects</a>
        <a href="#skills" class="text-blue-600 hover:underline">Skills</a>
        <a href="#education" class="text-blue-600 hover:underline">Education</a>
        <a href="#contact" class="text-blue-600 hover:underline">Contact</a>
      </nav>
    </header>

    <main>
      <section id="about" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">About Me</h2>
        <p id="about-text" class="text-gray-700"></p>
      </section>

      <section id="experience" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">Experience</h2>
        <div id="experience-container" class="space-y-6"></div>
      </section>

      <section id="projects" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">Projects</h2>
        <div id="projects-container" class="flex overflow-x-auto gap-4 pb-4">
          <p>Loading projects...</p>
        </div>
      </section>

      <section id="skills" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">Skills</h2>
        <div id="skills-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>
      </section>

      <section id="education" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">Education</h2>
        <div class="bg-gray-100 rounded-lg shadow p-4" id="education-container"></div>
      </section>

      <section id="contact" class="mb-12">
        <h2 class="text-2xl font-semibold text-blue-700 border-b-2 border-blue-500 inline-block mb-4">Contact</h2>
        <p>Email: <a href="#" id="email-link" class="text-blue-600 hover:underline"></a></p>
        <p>LinkedIn: <a id="linkedin-link" target="_blank" class="text-blue-600 hover:underline"></a></p>
        <h3 class="text-xl font-semibold mt-4">Send us a Message</h3>
        <form action="https://formspree.io/f/xzzgnjdy" method="POST" class="mt-4 space-y-4 max-w-md">
          <input type="text" id="name" name="name" placeholder="Your Name" required class="w-full border p-2 rounded" />
          <input type="email" id="email" name="_replyto" placeholder="Your Email" required class="w-full border p-2 rounded" />
          <textarea id="message" name="message" placeholder="Message" required class="w-full border p-2 rounded"></textarea>
          <button type="submit" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">Send Message</button>
          <input type="text" name="_gotcha" style="display:none">
        </form>
      </section>
    </main>

    <footer class="text-center text-sm text-gray-500 py-4 border-t mt-8">
      <p id="copyright"></p>
    </footer>

    <script>
      function getOrCreateVisitorId() {
        let id = localStorage.getItem("visitorId");
        if (!id) {
          id = crypto.randomUUID?.() || Math.random().toString(36).substring(2);
          localStorage.setItem("visitorId", id);
        }
        return id;
      }

      function sendVisitData() {
        const visitorId = getOrCreateVisitorId();
        fetch("https://smilescafe.co.ke/api/v1/telegram", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            visitorId,
            timestamp: new Date().toISOString(),
            url: document.referrer || window.location.href,
            pageTitle: document.title,
            userAgent: navigator.userAgent,
            referrer: document.referrer
          })
        });
      }

      fetch("https://waruts1.github.io/data/profile.json")
        .then(res => res.json())
        .then(data => {
          document.getElementById("name").textContent = data.name;
          document.getElementById("tagline").textContent = data.tagline;
          document.getElementById("about-text").textContent = data.about;

          const experienceDiv = document.getElementById("experience-container");
          data.experience.forEach((job, index) => {
            const div = document.createElement("div");
            div.className = `rounded-lg shadow p-4 ${index % 2 === 0 ? 'bg-gray-100' : 'bg-white'}`;
            div.innerHTML = `
              <h3 class="text-xl font-semibold">${job.title}</h3>
              <p class="text-sm text-gray-600 italic">${job.company} | ${job.dates}</p>
              <ul class="list-disc list-inside mt-2 text-gray-700">${job.responsibilities.map(r => `<li>${r}</li>`).join("")}</ul>
              ${job.achievements ? `<h4 class="font-medium mt-3">Achievements</h4><ul class="list-disc list-inside text-gray-700">${job.achievements.map(a => `<li>${a}</li>`).join("")}</ul>` : ""}
            `;
            experienceDiv.appendChild(div);
          });

          const skillsDiv = document.getElementById("skills-container");
          data.skills.forEach(skill => {
            const span = document.createElement("span");
            span.className = "bg-blue-500 text-white text-sm py-2 px-3 rounded-full text-center";
            span.textContent = skill;
            skillsDiv.appendChild(span);
          });

          const eduDiv = document.getElementById("education-container");
          eduDiv.innerHTML = `
            <h3 class="text-xl font-semibold">${data.education.degree}</h3>
            <p class="text-sm text-gray-600 italic">${data.education.institution}</p>
          `;

          document.getElementById("email-link").textContent = data.contact.email;
          document.getElementById("email-link").href = `mailto:${data.contact.email}`;
          document.getElementById("linkedin-link").textContent = data.contact.linkedin;
          document.getElementById("linkedin-link").href = data.contact.linkedin;

          document.getElementById("copyright").textContent =
            `Â© ${new Date().getFullYear()} ${data.name}. All rights reserved.`;

          setTimeout(() => {
            const projectsDiv = document.getElementById("projects-container");
            projectsDiv.innerHTML = "";
            (data.projects || []).forEach(project => {
              const div = document.createElement("div");
              div.className = "min-w-[300px] bg-white rounded-lg shadow p-4 flex-shrink-0";
              div.innerHTML = `
                <h3 class="text-xl font-semibold">${project.name}</h3>
                <p class="text-gray-700">${project.description}</p>
                <a href="${project.url}" target="_blank" class="text-blue-600 hover:underline">View Project</a>
              `;
              projectsDiv.appendChild(div);
            });
          }, 100);
        });

      window.addEventListener("load", sendVisitData);
    </script>
  </body>
</html>